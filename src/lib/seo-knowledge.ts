export const SEO_KNOWLEDGE_BASE = {
  packages: {
    silver: {
      pages: 3,
      blogs: 3,
      gbpPosts: 8,
      improvements: 8,
      description: 'content updates, metadata, schema, internal links, etc.',
    },
    gold: {
      pages: 5,
      blogs: 6,
      gbpPosts: 12,
      improvements: 10,
      description: 'content updates, metadata, schema, internal links, etc.',
    },
    platinum: {
      pages: 9,
      blogs: 12,
      gbpPosts: 20,
      improvements: 20,
      description: 'content updates, metadata, schema, internal links, etc.',
    },
  },

  faqs: [
    {
      question: 'What does my SEO package include each month?',
      answer: `Each package is designed to build authority, visibility, and organic lead generation through consistent, high-quality content and optimization. Here's what's included monthly in each tier. All content is high quality, original and targeted content for areas you serve and the vehicles you sell.

Silver Package:
• 3 pages
• 3 blogs
• 8 Google Business Profile (GBP) posts
• 8 SEO improvements/changes (content updates, metadata, schema, internal links, etc.)

Gold Package:
• 5 pages
• 6 blogs
• 12 GBP posts
• 10 SEO improvements/changes

Platinum Package:
• 9 pages
• 12 blogs
• 20 GBP posts
• 20 SEO improvements/changes

Each deliverable is tailored to your inventory, services, and target cities to ensure your dealership appears for relevant local and product-based searches. Our content is created to reflect real buyer intent and search behavior.`,
    },
    {
      question: 'How long does it take to complete the SEO content each month?',
      answer: `Our work is completed throughout the month in a structured, consistent schedule. Quick-turn items like GBP posts are spread out to maintain weekly visibility, while more robust SEO pages require detailed research, keyword optimization, technical tagging (metadata, schema), and detailed quality assurance (QA). These go through multiple internal reviews before publishing. We're actively working on your campaign every week, not just once a month, and are available to accommodate timely requests or one-off needs along the way. All content is added to your sitemap and submitted to Google for indexing.`,
    },
    {
      question: 'What are the Key Performance Indicators (KPIs) for SEO?',
      answer: `We track and report the KPIs that matter most to your organic visibility and lead generation:

• Keyword Rankings – You'll receive a monthly keyword ranking report with position tracking across top models and services.
• Organic Traffic – Via Google Analytics 4 (GA4), we measure sessions, engagement rate, time on page, and Key Events.
• Search Visibility – Search Console data tracks impressions and click-throughs, helping us understand how often you're appearing in search, including AI-driven results like AI Overviews.
• Conversions (Key Events) – These include tracked actions such as click-to-call, form submissions, and vehicle VDP/SRP interactions.

SEO takes time to mature, but over months of consistent publishing and optimization, the content builds topical authority and improves visibility across both traditional and AI-enhanced search results.`,
    },
    {
      question:
        'Should I be concerned if organic traffic is down year-over-year or month-over-month?',
      answer: `Organic traffic can fluctuate for reasons beyond SEO performance. When reviewing dips, we assess how you are ranking, if anything has changed recently in your indexing time or rankings, where the competition is doing well or where opportunities for taking more traffic might be (for example, do you have a pump in/pump out report we can review to help determine where missed opportunities for Organic visibility might be?). We also look at:

• Increased Paid Media Spend – Paid campaigns can cannibalize organic clicks, but not always. It's always a good idea to double check all marketing strategies for any unnecessary overlap.
• GBP traffic attribution – Google often places dealership GBP clicks into "Unassigned" or "Direct" in GA4, so it can be a good idea to check for indicators of this.
• Impression Trends – Higher impressions but fewer clicks may still indicate better search visibility, especially with the rise of zero-click searches and AI-generated answers.

Rather than focusing on a single metric, we take a full-funnel approach to SEO performance and evaluate conversions, impressions, and keyword movements together.`,
    },
    {
      question: 'What metadata and schema do you optimize?',
      answer: `We manually optimize all core pages across your Navigation, like New and Used SRPs, New and Used VDPs, home page, etc. We add custom metadata and our custom schema, including adding target cities to meta titles and descriptions, and adding schema including Vehicle schema, FAQ schema, and AutoDealer schema. This helps search engines scan and organize content for better indexing and rankings.`,
    },
    {
      question: 'How long does it take for SEO efforts to produce noticeable improvements?',
      answer: `SEO is a long-term investment. While smaller improvements can occur within the first 30–60 days, most dealers see stronger ranking increases and traffic growth within 3–6 months, with peak momentum often kicking in after 6 months. That said, if your site had minimal SEO before, optimizations made in the first few weeks can yield early wins.

Search engines reward consistency, authority, and depth of content—so the more regularly we build and optimize, the faster your presence grows.`,
    },
    {
      question: "What kind of SEO content do you build, and what's the strategy?",
      answer: `We focus on building a library of high-quality, interconnected content that AI and traditional search engines can easily crawl and trust. This includes:

• Model Overview Pages – Showcasing features, specs, and inventory configuration
• Trim Level Pages – Targeting specific buyers researching trim levels across your model line-up
• Comparison Pages – Pitting your models against competitors in your area/market, providing factual information and charts to showcase the models you sell in the best light
• "Everything You Need to Know" pages – Comprehensive landing pages targeting a specific vehicle in a specific target area, including key information about the vehicle and your dealership, common FAQs, buying considerations, and more
• "Serving City" Pages – Localized landing pages for nearby markets
• Blogs – Covering buying trends, FAQs, OEM events, service insights, etc.
• Google Business Profile Posts – Professionally written posts linking back to pages or inventory, including Offer posts (Specials) and detailed SEO content posts`,
    },
    {
      question: 'What happens if I switch website providers?',
      answer: `We handle the full SEO content migration at no additional charge. This includes:

• Rebuilding your existing SEO content onto the new CMS by migrating and re-building our pages and blogs
• Submitting the new sitemap to Google Search Console
• Setting up 301 redirects as needed
• QA testing for broken links, indexing issues, etc.

We ensure continuity and site health during the transition. Just let us know once you plan to change website providers and we will start the process of migrating the content over ASAP.`,
    },
    {
      question: 'What makes a page rank well on Google and other search engines?',
      answer: `Ranking success is the result of aligning technical SEO, content quality, and user intent. We ensure every page includes:

• Fully optimized metadata, schema, and internal links
• Clean HTML structure with proper heading use (H1-H6)
• Alt text on high-quality OEM imagery
• Detailed and helpful content
• Local SEO targeting nearby cities and relevant inventory
• Crosslinks to SRP, internal linking, and inventory configurations

Search engines reward relevance, clarity, and authority. Our pages are built to provide all three.`,
    },
    {
      question: 'How are you addressing GEO (Generative Engine Optimization) and AI Overviews?',
      answer: `Our SEO strategy already prioritized the kinds of content AI Overviews prefer: structured, well-organized, and helpful. But we're also enhancing this by:

• Adding FAQs, comparison tables, and bullet-point summaries
• Creating content with clear sections and intuitive flow
• Targeting informational queries AI systems prioritize
• Ensuring technical SEO like schema, metadata, and page structure is AI-friendly

According to Google: "apply the same foundational SEO best practices for AI features as you do for Google Search overall." That's what we've always done—only now, we're refining it for the next generation of search.`,
    },
  ],

  contentTypes: {
    pages: [
      'Model Overview Pages',
      'Trim Level Pages',
      'Comparison Pages',
      'Everything You Need to Know pages',
      'Serving City Pages',
    ],
    blogs: ['Buying trends', 'FAQs', 'OEM events', 'Service insights'],
    gbpPosts: ['Offer posts (Specials)', 'Detailed SEO content posts'],
  },

  kpis: ['Keyword Rankings', 'Organic Traffic', 'Search Visibility', 'Conversions (Key Events)'],

  optimizations: [
    'Metadata optimization',
    'Schema markup',
    'Internal linking',
    'Content updates',
    'Technical SEO improvements',
  ],
}

export function generateSystemPrompt(agencyName: string = 'your dealership'): string {
  return `You are Rylie, an AI-powered SEO assistant specializing in automotive dealership SEO. You work for ${agencyName} and help dealerships improve their online visibility and organic lead generation.

IMPORTANT CONTEXT:
You have deep knowledge about SEO services, packages, and best practices for automotive dealerships. When answering questions, reference the specific details about SEO packages, timelines, KPIs, and strategies that you know.

KEY KNOWLEDGE AREAS:
1. SEO Package Details (Silver, Gold, Platinum) - know exact deliverables for each
2. Content Types - pages, blogs, GBP posts, and their specific purposes
3. Timeline Expectations - 3-6 months for strong results, 6+ months for peak momentum
4. KPIs - keyword rankings, organic traffic, search visibility, conversions
5. Technical SEO - metadata, schema markup, internal linking
6. Content Strategy - model pages, comparison pages, local city pages, etc.
7. Migration Support - free website provider transitions
8. GEO/AI Optimization - structured content for AI Overviews

COMMUNICATION STYLE:
- Be professional but conversational
- Provide specific, actionable advice
- Reference actual numbers and timelines when relevant
- Acknowledge that SEO is a long-term investment
- Be transparent about realistic expectations
- Use bullet points for clarity when listing multiple items
- Always tie recommendations back to dealership goals

When users ask about:
- Package contents: Provide specific numbers and types of deliverables
- Timelines: Explain the consistent monthly schedule and long-term nature of SEO
- Performance concerns: Address multiple factors that affect organic traffic
- Technical details: Explain optimizations in dealership-friendly terms
- Results: Set realistic expectations (30-60 days for early wins, 3-6 months for strong growth)

Remember: You're here to help dealerships understand and maximize their SEO investment. Be helpful, specific, and focused on their success.`
}

export function findRelevantFAQ(query: string): string | null {
  const lowerQuery = query.toLowerCase()

  // Keywords to FAQ mapping
  const keywordMap: { [key: string]: number } = {
    package: 0,
    include: 0,
    silver: 0,
    gold: 0,
    platinum: 0,
    deliverables: 0,
    'how long': 1,
    timeline: 1,
    schedule: 1,
    kpi: 2,
    metrics: 2,
    performance: 2,
    'traffic down': 3,
    'traffic decrease': 3,
    'organic traffic': 3,
    metadata: 4,
    schema: 4,
    optimization: 4,
    results: 5,
    improvements: 5,
    notice: 5,
    content: 6,
    strategy: 6,
    build: 6,
    switch: 7,
    provider: 7,
    migration: 7,
    rank: 8,
    ranking: 8,
    geo: 9,
    'ai overview': 9,
    generative: 9,
  }

  // Find best matching FAQ
  for (const [keyword, faqIndex] of Object.entries(keywordMap)) {
    if (lowerQuery.includes(keyword)) {
      return SEO_KNOWLEDGE_BASE.faqs[faqIndex].answer
    }
  }

  return null
}
